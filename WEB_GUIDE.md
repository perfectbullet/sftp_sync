# SFTP Sync Web Interface 使用指南

## 快速开始

### 1. 启动Web服务器

```bash
sftp-sync-web
```

服务器将在 `http://localhost:8000` 启动。

自定义主机和端口：

```bash
sftp-sync-web --host 0.0.0.0 --port 8080
```

### 2. 访问Web界面

在浏览器中打开 `http://localhost:8000`

## 功能介绍

### 同步配置

在"同步配置"标签页中，您可以：

1. **配置连接设置**
   - 输入远程主机地址、端口、用户名
   - 选择认证方式（密码或SSH密钥）
   - 点击"测试连接"验证配置

2. **设置目录**
   - 本地目录：要同步的本地文件夹路径
   - 远程目录：目标远程服务器路径

3. **配置文件过滤**
   - 包含模式：指定要同步的文件类型（如 `*.py`, `*.js`）
   - 排除模式：排除不需要同步的文件（如 `*.pyc`, `node_modules`）

4. **同步选项**
   - 删除远程多余文件：删除远程存在但本地不存在的文件
   - 保留文件权限：同步时保持文件权限
   - 预演模式：仅预览更改，不实际执行
   - 详细输出：显示详细的同步日志

5. **保存配置**
   - 点击"保存配置"按钮
   - 输入配置名称（如：生产环境、测试环境）
   - 配置将保存到 `~/.sftp_sync/configs/` 目录

6. **开始同步**
   - 点击"开始同步"按钮
   - 系统会在后台启动同步任务
   - 切换到"同步状态"标签查看进度

### 同步状态

在"同步状态"标签页中，您可以：

1. **查看所有同步任务**
   - 任务ID和状态（等待中、运行中、已完成、失败）
   - 开始时间和完成时间
   - 同步统计（上传、跳过、删除、错误数量）

2. **实时监控**
   - 页面每3秒自动刷新任务状态
   - 点击"刷新"按钮手动更新

3. **查看任务详情**
   - 每个任务卡片显示完整的同步信息
   - 如果任务失败，会显示错误信息

### 配置管理

在"配置管理"标签页中，您可以：

1. **查看所有保存的配置**
   - 配置名称和修改时间
   - 配置文件路径

2. **管理配置**
   - 点击"查看"按钮查看配置详情
   - 点击"删除"按钮删除不需要的配置

3. **加载配置**
   - 返回"同步配置"标签
   - 点击"加载配置"按钮
   - 选择要加载的配置

## 安全建议

1. **使用SSH密钥认证**
   - 相比密码认证更安全
   - 生成密钥：`ssh-keygen -t rsa -b 4096`
   - 将公钥添加到远程服务器

2. **添加主机密钥**
   - 首次连接前，添加主机密钥到known_hosts：
   ```bash
   ssh-keyscan -H your-host.com >> ~/.ssh/known_hosts
   ```

3. **配置文件安全**
   - 配置文件存储在 `~/.sftp_sync/configs/`
   - 建议设置适当的文件权限：`chmod 600 ~/.sftp_sync/configs/*`

4. **生产环境部署**
   - 使用反向代理（如Nginx）
   - 配置HTTPS加密
   - 限制CORS允许的源

## API文档

访问 `http://localhost:8000/docs` 查看完整的API文档（Swagger UI）

## 常见问题

### Q: 连接测试失败
A: 检查以下几点：
- 主机地址和端口是否正确
- 用户名和密码/密钥是否正确
- 远程服务器SSH服务是否运行
- 主机密钥是否已添加到known_hosts

### Q: 同步任务一直处于"运行中"状态
A: 可能是同步大量文件需要时间，请耐心等待。查看"同步状态"标签了解进度。

### Q: 如何查看详细的同步日志
A: 在配置中勾选"详细输出"选项，日志会在服务器控制台输出。

### Q: Web界面显示空白页
A: 确保已经构建前端：
```bash
cd web-ui
npm install
npm run build
```

## 开发模式

如果您想修改Web界面：

```bash
# 终端1：启动后端API服务器
sftp-sync-web

# 终端2：启动前端开发服务器
cd web-ui
npm run dev
```

前端开发服务器会在 `http://localhost:5173` 运行，并自动代理API请求到后端。
